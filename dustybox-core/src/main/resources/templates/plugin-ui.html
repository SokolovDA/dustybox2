<!-- dustybox-core/src/main/resources/templates/plugin-ui.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Dustybox - Plugin Platform</title>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã –ø–ª–∞–≥–∏–Ω–æ–≤ -->
    <link th:each="resource : ${resources}"
          th:href="${resource.type == 'css' ? resource.url : ''}"
          th:if="${resource.type == 'css'}"
          rel="stylesheet">
</head>
<body>
<!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏–∑ –ø–ª–∞–≥–∏–Ω–æ–≤ -->
<nav class="navbar">
    <div class="nav-brand">üéõÔ∏è Dustybox</div>
    <div class="nav-items">
        <a th:each="item : ${menuItems}"
           th:href="@{${item.path}}"
           th:text="${item.title}"
           class="nav-item">
            <i th:text="${item.icon}"></i>
        </a>
    </div>
</nav>

<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤ -->
<div id="plugin-container">
    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –ø–ª–∞–≥–∏–Ω–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
</div>

<!-- –°–∫—Ä–∏–ø—Ç—ã –ø–ª–∞–≥–∏–Ω–æ–≤ -->
<script th:each="resource : ${resources}"
        th:src="${resource.type == 'js' ? resource.url : ''}"
        th:if="${resource.type == 'js'}"></script>

<!-- –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —è–¥—Ä–∞ -->
<script>
    class DustyboxPluginManager {
        constructor() {
            this.plugins = []
            this.currentPlugin = null
        }

        async loadPluginUI(pluginName, path) {
            const response = await fetch(`/plugins/${pluginName}/${path}`)
            const html = await response.text()

            document.getElementById('plugin-container').innerHTML = html
            this.currentPlugin = pluginName
        }

        async callPluginApi(pluginName, endpoint, method = 'GET', data = null) {
            const options = {
                method: method,
                headers: { 'Content-Type': 'application/json' }
            }

            if (data) {
                options.body = JSON.stringify(data)
            }

            const response = await fetch(`/plugins/${pluginName}${endpoint}`, options)
            return await response.json()
        }
    }

    window.Dustybox = new DustyboxPluginManager()
</script>
</body>
</html>